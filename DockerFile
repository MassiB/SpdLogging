# Use the official Docker image for Windows with Visual Studio Build Tools
FROM mcr.microsoft.com/dotnet/framework/sdk:4.8

# Install dependencies
RUN powershell -Command Set-ExecutionPolicy Bypass -Scope Process -Force; \
    [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; \
    iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1')); \
    choco install -y git cmake

# Clone the spdlog repository
RUN git clone https://github.com/gabime/spdlog.git C:/spdlog

# Set the working directory for your application
WORKDIR /app

# Copy your project files into the container
COPY . /app

# Build spdlog
WORKDIR /spdlog
RUN mkdir build && cd build && cmake .. && cmake --build .

# Build your application
WORKDIR /app
RUN mkdir build && cd build && cmake .. && cmake --build .

# Specify the command to run your application
CMD ["./build/SPDLOGGING.exe"]
